import{_ as p,c as l,b as n,h as a,a as e,o,e as r}from"./app.8d28953e.js";const k=JSON.parse('{"title":"lerna\u4F7F\u7528\u3010\u6458\u5F55\u3011","description":"","frontmatter":{},"headers":[],"relativePath":"blogs/automation/package-manage/monorepo/lerna.md","lastUpdated":1665325936000}'),c={name:"blogs/automation/package-manage/monorepo/lerna.md"},t=a(`<h1 id="lerna\u4F7F\u7528\u3010\u6458\u5F55\u3011" tabindex="-1">lerna\u4F7F\u7528\u3010\u6458\u5F55\u3011 <a class="header-anchor" href="#lerna\u4F7F\u7528\u3010\u6458\u5F55\u3011" aria-hidden="true">#</a></h1><p>\u539F\u535A\u5BA2\u94FE\u63A5<a href="https://juejin.cn/post/6844903918279852046" target="_blank" rel="noreferrer">https://juejin.cn/post/6844903918279852046</a></p><p><strong>1.\u5B89\u88C5lerna</strong></p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">npm i lerna -g</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>2.\u521B\u5EFAlerna\u9879\u76EE</strong></p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">lerna init</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>3.\u521B\u5EFAnpm\u5305</strong></p><p>\u5728packages\u91CC\u9762\u521B\u5EFA\u5305</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">lerna create package-c</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>4.\u589E\u52A0\u6A21\u5757\u4F9D\u8D56</strong></p><p>\u5206\u522B\u7ED9\u76F8\u5E94\u7684 package \u589E\u52A0\u4F9D\u8D56\u6A21\u5757</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">lerna add antd // \u4E3A\u6240\u6709 package \u589E\u52A0 antd \u6A21\u5757\uFF0C\u8FD9\u4E2A\u6A21\u5757\u4F1A\u88AB\u5B89\u88C5\u5230\u6BCF\u4E2A\u5305\u7684node_modules\u91CC\u9762</span></span>
<span class="line"><span style="color:#A6ACCD;">lerna add antd --scope @monorepo/react-app // \u4E3A @monorepo/react-app \u589E\u52A0 antd \u6A21\u5757 </span></span>
<span class="line"><span style="color:#A6ACCD;">lerna add @monorepo/package-a --scope @monorepo/react-app // \u589E\u52A0\u5185\u90E8\u6A21\u5757\u4E4B\u95F4\u7684\u4F9D\u8D56</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>5.\u4F9D\u8D56\u5305\u7BA1\u7406</strong></p><p>\u5F53\u6211\u4EEC\u7EF4\u62A4\u8FD9\u4E2A\u9879\u76EE\u65F6\uFF0C\u65B0\u62C9\u4E0B\u6765\u4ED3\u5E93\u7684\u4EE3\u7801\u540E\uFF0C\u9700\u8981\u4E3A\u5404\u4E2A package \u5B89\u88C5\u4F9D\u8D56\u5305\u3002lerna add \u65F6\u4E5F\u53D1\u73B0\u4E86\uFF0C\u4E3A\u67D0\u4E2A package \u5B89\u88C5\u7684\u5305\u88AB\u653E\u5230\u4E86\u8FD9\u4E2A package \u76EE\u5F55\u4E0B\u7684 <code>node_modules</code> \u76EE\u5F55\u4E0B\u3002\u8FD9\u6837\u5BF9\u4E8E\u591A\u4E2A package \u90FD\u4F9D\u8D56\u7684\u5305\uFF0C\u4F1A\u88AB\u591A\u4E2A package \u5B89\u88C5\u591A\u6B21\uFF0C\u5E76\u4E14\u6BCF\u4E2A package \u4E0B\u90FD\u7EF4\u62A4 <code>node_modules</code> \uFF0C\u4E5F\u4E0D\u6E05\u723D\u3002\u4E8E\u662F\u6211\u4EEC\u4F7F\u7528 --hoist \u6765\u628A\u6BCF\u4E2A package \u4E0B\u7684\u4F9D\u8D56\u5305\u90FD\u63D0\u5347\u5230\u5DE5\u7A0B\u6839\u76EE\u5F55\uFF0C\u6765\u964D\u4F4E\u5B89\u88C5\u4EE5\u53CA\u7BA1\u7406\u7684\u6210\u672C\u3002</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">lerna bootstrap --hoist</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>\u4E3A\u4E86\u7701\u53BB\u6BCF\u6B21\u90FD\u8F93\u5165 --hoist \u53C2\u6570\u7684\u9EBB\u70E6\uFF0C\u53EF\u4EE5\u5728 lerna.json \u914D\u7F6E\uFF1A</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  &quot;packages&quot;: [</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;packages/*&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  ],</span></span>
<span class="line"><span style="color:#A6ACCD;">  &quot;command&quot;: {</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;bootstrap&quot;: {</span></span>
<span class="line"><span style="color:#A6ACCD;">      &quot;hoist&quot;: true</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">  },</span></span>
<span class="line"><span style="color:#A6ACCD;">  &quot;version&quot;: &quot;0.0.1-alpha.0&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>PS:\u5173\u4E8E lerna link \u548C lerna bootstrap</p><p>\u5982\u679C packages \u4E0B\u7684\u5305\u6709\u76F8\u4E92\u4F9D\u8D56\uFF0C\u6211\u8BD5\u4E86\u4E00\u4E0B\u76F4\u63A5lerna bootstrap\uFF0C\u5DF2\u7ECF\u5E2E\u6211\u4EEC\u8FDB\u884C\u4E86 lerna link \u4E86\uFF0C\u800C lerna link \u53EA\u662F\u5E2E\u6211\u4EEC\u505A\u8F6F\u94FE\u63A5\u5DE5\u4F5C\u3002</p><p>\u800C\u4E14\u5373\u4F7F\u53D1\u5E03\u5230\u7EBF\u4E0A\uFF0C\u6267\u884C <code>lerna bootstrap</code> \uFF0C\u4E5F\u662F\u4F1A link \u672C\u5730\u4F9D\u8D56\u5305\uFF0C\u800C\u4E0D\u662F\u53BB\u7EBF\u4E0A\u5B89\u88C5\u3002</p><p>\u6240\u4EE5\u611F\u89C9\u53EA\u9700\u4F7F\u7528 <code>lerna bootstrap</code> \u547D\u4EE4\u5C31\u884C\u4E86\u3002</p><p><strong>6.\u5220\u9664\u4F9D\u8D56\u5305</strong></p><p>\u5220\u9664\u6240\u6709\u5305\u7684node_modules\uFF0C\u9876\u5C42\u7684node_modules\u4E0D\u4F1A\u88AB\u5220\u9664</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">lerna clean</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div>`,24),i=a(`<p><strong>7.\u67E5\u770Bpackages\u4E0B\u9762\u6709\u54EA\u4E9B\u5305</strong></p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">lerna ls</span></span>
<span class="line"><span style="color:#A6ACCD;">lerna list</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div>`,2),d=a(`<p><strong>8.\u8FD0\u884C\u67D0\u4E2A\u5305\u91CC\u7684\u547D\u4EE4<code>lerna run &lt; script &gt;</code></strong></p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">lerna run --scope my-component test</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>9.\u5728\u67D0\u4E2A\u5305\u6216\u8005\u6240\u6709\u5305\u8FD0\u884C\u547D\u4EE4<code>lerna exec -- &lt; command &gt;</code></strong></p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">// \u5728\u6BCF\u4E2A\u5305\u8FD0\u884C\u547D\u4EE4</span></span>
<span class="line"><span style="color:#A6ACCD;">lerna exec -- rm -rf ./node_modules</span></span>
<span class="line"><span style="color:#A6ACCD;">// \u5728\u67D0\u4E2A\u5305\u8FD0\u884C\u547D\u4EE4</span></span>
<span class="line"><span style="color:#A6ACCD;">lerna exec --scope my-component</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>10.\u5217\u51FA\u4E0B\u6B21\u53D1\u7248\u8981\u66F4\u65B0\u7684\u5305</strong></p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">lerna changed</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>11.\u53D1\u5E03\u5305</strong></p><p>\u5728\u53D1\u5E03\u5305\u4E4B\u524D\u4E00\u5B9A\u8981\u6709\u4E00\u4E2Agithub\u4ED3\u5E93\uFF0C\u800C\u4E14\u8FD8\u9700\u8981\u6709\u4E00\u4E2Amaster\u5206\u652F\uFF0C\u4E0D\u7136\u6D41\u7A0B\u8D70\u4E0D\u4E0B\u53BB\u3002\u800C\u4E14\u8981\u767B\u5F55npm\u3002</p><p>\u5728\u767B\u5F55npm\u7684\u65F6\u5019\u4E00\u5B9A\u8981\u5173\u6CE8\u4E00\u4E0Bnpm\u7684\u955C\u50CF\u662F\u5426\u6B63\u786E\uFF0C\u6211\u4E4B\u524D\u7684\u955C\u50CF\u662Ftaobao\u7684\uFF0C\u6240\u4EE5\u5BFC\u81F4\u767B\u5F55\u4E00\u76F4\u62A5403\uFF0C\u5207\u6362\u4E3A<a href="https://registry.npmjs.org/" target="_blank" rel="noreferrer">https://registry.npmjs.org/</a> \u540E\u8F93\u5165\u8D26\u53F7\u3001\u5BC6\u7801\uFF0C\u90AE\u7BB1\uFF0C\u4EE5\u53CA\u90AE\u7BB1\u9A8C\u8BC1\u7801\u5373\u53EF\u767B\u5F55\u6210\u529F\u3002</p><p>\u7136\u540E\u8F93\u5165</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">lerna publish</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>\u8F93\u5165\u547D\u4EE4\u884C\u4E4B\u540E\u4F1A\u51FA\u73B0\u8FD9\u6837\u7684\u754C\u9762</p>`,12),u=e("p",null,"\u9009\u62E9\u6211\u4EEC\u8981\u53D1\u7248\u7684\u7248\u672C\u53F7\uFF0C\u662F\u5927\u7248\u672C\u8FD8\u662F\u5C0F\u7248\u672C\uFF1F\u9009\u62E9\u5B8C\u4E4B\u540E\u4F1A\u5217\u51FA\u8FD9\u6B21\u9700\u8981\u66F4\u65B0\u7684\u5305",-1),m=e("p",null,"\u7136\u540E\u5C31\u53D1\u5E03\u6210\u529F\u5566",-1);function b(g,A,C,_,y,v){const s=r("Image");return o(),l("div",null,[t,n(s,{src:"/automation/package-manage/monorepo/lerna/1.png"},null,8,["src"]),i,n(s,{src:"/automation/package-manage/monorepo/lerna/2.png"},null,8,["src"]),d,n(s,{src:"/automation/package-manage/monorepo/lerna/3.png"},null,8,["src"]),u,n(s,{src:"/automation/package-manage/monorepo/lerna/4.png"},null,8,["src"]),m])}const h=p(c,[["render",b]]);export{k as __pageData,h as default};
