<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>如何调试react源码 | Nangxi&#39;s docs</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Nangxi&#39;s docs">
    
    <link rel="preload" href="/nxf-notes/assets/css/0.styles.b54b9ddc.css" as="style"><link rel="preload" href="/nxf-notes/assets/js/app.cd794865.js" as="script"><link rel="preload" href="/nxf-notes/assets/js/2.dc5a3d57.js" as="script"><link rel="preload" href="/nxf-notes/assets/js/18.e542e422.js" as="script"><link rel="prefetch" href="/nxf-notes/assets/js/10.376969f8.js"><link rel="prefetch" href="/nxf-notes/assets/js/11.b7cfb206.js"><link rel="prefetch" href="/nxf-notes/assets/js/12.ac174cb7.js"><link rel="prefetch" href="/nxf-notes/assets/js/13.2e7f3cee.js"><link rel="prefetch" href="/nxf-notes/assets/js/14.21284f9f.js"><link rel="prefetch" href="/nxf-notes/assets/js/15.bb4f9f89.js"><link rel="prefetch" href="/nxf-notes/assets/js/16.f863ff74.js"><link rel="prefetch" href="/nxf-notes/assets/js/17.7137ef6c.js"><link rel="prefetch" href="/nxf-notes/assets/js/19.92702bfa.js"><link rel="prefetch" href="/nxf-notes/assets/js/20.f4f96a57.js"><link rel="prefetch" href="/nxf-notes/assets/js/21.9384358c.js"><link rel="prefetch" href="/nxf-notes/assets/js/22.0fc5472c.js"><link rel="prefetch" href="/nxf-notes/assets/js/23.30bf512d.js"><link rel="prefetch" href="/nxf-notes/assets/js/24.414f9dd3.js"><link rel="prefetch" href="/nxf-notes/assets/js/25.70be0545.js"><link rel="prefetch" href="/nxf-notes/assets/js/26.2db442da.js"><link rel="prefetch" href="/nxf-notes/assets/js/27.e0154de6.js"><link rel="prefetch" href="/nxf-notes/assets/js/28.ed981891.js"><link rel="prefetch" href="/nxf-notes/assets/js/29.b2b5a47c.js"><link rel="prefetch" href="/nxf-notes/assets/js/3.0ce7fa96.js"><link rel="prefetch" href="/nxf-notes/assets/js/30.21281572.js"><link rel="prefetch" href="/nxf-notes/assets/js/31.67a0d1db.js"><link rel="prefetch" href="/nxf-notes/assets/js/32.db6c7415.js"><link rel="prefetch" href="/nxf-notes/assets/js/33.12659d82.js"><link rel="prefetch" href="/nxf-notes/assets/js/4.43879640.js"><link rel="prefetch" href="/nxf-notes/assets/js/5.60572b82.js"><link rel="prefetch" href="/nxf-notes/assets/js/6.22f00265.js"><link rel="prefetch" href="/nxf-notes/assets/js/7.b6a287fb.js"><link rel="prefetch" href="/nxf-notes/assets/js/8.5d14f72d.js"><link rel="prefetch" href="/nxf-notes/assets/js/9.71ceb8ff.js">
    <link rel="stylesheet" href="/nxf-notes/assets/css/0.styles.b54b9ddc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/nxf-notes/" class="home-link router-link-active"><!----> <span class="site-name">Nangxi's docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nxf-notes/blogs/front-frame/vue3/introduction.html" class="nav-link">
  Vue3
</a></li><li class="dropdown-item"><!----> <a href="/nxf-notes/blogs/front-frame/react/introduction.html" class="nav-link">
  React
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="自动化" class="dropdown-title"><span class="title">自动化</span> <span class="arrow down"></span></button> <button type="button" aria-label="自动化" class="mobile-dropdown-title"><span class="title">自动化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nxf-notes/blogs/automation/webpack/introduction.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/nxf-notes/blogs/automation/esbuild/introduction.html" class="nav-link">
  ESBuild
</a></li></ul></div></div><div class="nav-item"><a href="/nxf-notes/blogs/js&amp;ts/js/coriolization-of-the-function.html" class="nav-link">
  JS&amp;TS
</a></div><div class="nav-item"><a href="/nxf-notes/blogs/browser/operating-machining.html" class="nav-link">
  浏览器
</a></div><div class="nav-item"><a href="/nxf-notes/blogs/node/introduction.html" class="nav-link">
  Node
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于我" class="dropdown-title"><span class="title">关于我</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于我" class="mobile-dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Nangxif" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/1821245353761704/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nxf-notes/blogs/front-frame/vue3/introduction.html" class="nav-link">
  Vue3
</a></li><li class="dropdown-item"><!----> <a href="/nxf-notes/blogs/front-frame/react/introduction.html" class="nav-link">
  React
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="自动化" class="dropdown-title"><span class="title">自动化</span> <span class="arrow down"></span></button> <button type="button" aria-label="自动化" class="mobile-dropdown-title"><span class="title">自动化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nxf-notes/blogs/automation/webpack/introduction.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/nxf-notes/blogs/automation/esbuild/introduction.html" class="nav-link">
  ESBuild
</a></li></ul></div></div><div class="nav-item"><a href="/nxf-notes/blogs/js&amp;ts/js/coriolization-of-the-function.html" class="nav-link">
  JS&amp;TS
</a></div><div class="nav-item"><a href="/nxf-notes/blogs/browser/operating-machining.html" class="nav-link">
  浏览器
</a></div><div class="nav-item"><a href="/nxf-notes/blogs/node/introduction.html" class="nav-link">
  Node
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于我" class="dropdown-title"><span class="title">关于我</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于我" class="mobile-dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Nangxif" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/1821245353761704/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue3</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>React</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nxf-notes/blogs/front-frame/react/introduction.html" class="sidebar-link">introduction</a></li><li><a href="/nxf-notes/blogs/front-frame/react/debug-react.html" aria-current="page" class="active sidebar-link">如何调试react源码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nxf-notes/blogs/front-frame/react/debug-react.html#_1-创建一个react项目" class="sidebar-link">1.创建一个react项目</a></li><li class="sidebar-sub-header"><a href="/nxf-notes/blogs/front-frame/react/debug-react.html#_2-运行eject-创建config目录-暴露webpack配置" class="sidebar-link">2.运行eject，创建config目录，暴露webpack配置</a></li><li class="sidebar-sub-header"><a href="/nxf-notes/blogs/front-frame/react/debug-react.html#_3-将facebook仓库的react源码clone或者下载-放至src-react目录下" class="sidebar-link">3.将facebook仓库的react源码clone或者下载，放至src/react目录下</a></li><li class="sidebar-sub-header"><a href="/nxf-notes/blogs/front-frame/react/debug-react.html#_4-修改react-app-src-index-js里面关于react的引入方式" class="sidebar-link">4.修改react-app/src/index.js里面关于react的引入方式</a></li><li class="sidebar-sub-header"><a href="/nxf-notes/blogs/front-frame/react/debug-react.html#_5-react-app-config-webpack-config-js修改alias指向-指向下载到本地的react代码" class="sidebar-link">5.react-app/config/webpack.config.js修改alias指向，指向下载到本地的react代码</a></li><li class="sidebar-sub-header"><a href="/nxf-notes/blogs/front-frame/react/debug-react.html#_6-关掉eslint" class="sidebar-link">6.关掉eslint</a></li><li class="sidebar-sub-header"><a href="/nxf-notes/blogs/front-frame/react/debug-react.html#_7-先将项目运行起来" class="sidebar-link">7.先将项目运行起来</a></li><li class="sidebar-sub-header"><a href="/nxf-notes/blogs/front-frame/react/debug-react.html#_8-修改第一个遇到的错误" class="sidebar-link">8.修改第一个遇到的错误</a></li><li class="sidebar-sub-header"><a href="/nxf-notes/blogs/front-frame/react/debug-react.html#_9-项目跑起来了-但是我们依然能在浏览器控制台看到报错" class="sidebar-link">9.项目跑起来了，但是我们依然能在浏览器控制台看到报错</a></li><li class="sidebar-sub-header"><a href="/nxf-notes/blogs/front-frame/react/debug-react.html#_10-解决-secret-internals-do-not-use-or-you-will-be-fired问题" class="sidebar-link">10.解决_SECRETINTERNALSDONOTUSEORYOUWILLBEFIRED问题</a></li><li class="sidebar-sub-header"><a href="/nxf-notes/blogs/front-frame/react/debug-react.html#_11-this-module-must-be-shimmed-by-a-specific-renderer" class="sidebar-link">11.This module must be shimmed by a specific renderer</a></li><li class="sidebar-sub-header"><a href="/nxf-notes/blogs/front-frame/react/debug-react.html#_12-跑起来了" class="sidebar-link">12.跑起来了</a></li><li class="sidebar-sub-header"><a href="/nxf-notes/blogs/front-frame/react/debug-react.html#_13-开始debug" class="sidebar-link">13.开始debug</a></li><li class="sidebar-sub-header"><a href="/nxf-notes/blogs/front-frame/react/debug-react.html#_14-大功告成" class="sidebar-link">14.大功告成</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="如何调试react源码"><a href="#如何调试react源码" class="header-anchor">#</a> 如何调试react源码</h1> <p>我们要了解react的原理，难免需要调试源码，接下来直接进入正题，一步一步傻瓜式地操作下来就可以调试了。</p> <h2 id="_1-创建一个react项目"><a href="#_1-创建一个react项目" class="header-anchor">#</a> 1.创建一个react项目</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npx create<span class="token operator">-</span>react<span class="token operator">-</span>app react<span class="token operator">-</span>app
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_2-运行eject-创建config目录-暴露webpack配置"><a href="#_2-运行eject-创建config目录-暴露webpack配置" class="header-anchor">#</a> 2.运行eject，创建config目录，暴露webpack配置</h2> <p>步骤1创建的项目刚好有一段脚本可以创建config，这个文件夹下面会有可以打包项目的webpack.config.js配置文件。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm run eject
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>跑完这个命令，会自动把之前启动项目的工具react-scripts替换为eject生成的node scripts/start.js<br>
跑命令前的样子</p> <img src="/nxf-notes/front-frame/react/debug-react/1.png"> <p>跑命令后的样子</p> <img src="/nxf-notes/front-frame/react/debug-react/2.png"> <p>跑完这段命令会创建.git文件夹并在项目生成仓库，如果我们是先进行3步骤再进行2步骤，那么在进行2步骤的时候会报错，说仓库还有未commit的代码，导致eject命令无法执行，这时候我们需要将代码全部commit，再跑这串命令。</p> <h2 id="_3-将facebook仓库的react源码clone或者下载-放至src-react目录下"><a href="#_3-将facebook仓库的react源码clone或者下载-放至src-react目录下" class="header-anchor">#</a> 3.将facebook仓库的react源码clone或者下载，放至src/react目录下</h2> <img src="/nxf-notes/front-frame/react/debug-react/3.png"> <h2 id="_4-修改react-app-src-index-js里面关于react的引入方式"><a href="#_4-修改react-app-src-index-js里面关于react的引入方式" class="header-anchor">#</a> 4.修改react-app/src/index.js里面关于react的引入方式</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
* 原代码
* import React from 'react';
* import ReactDOM from 'react-dom/client';
*/</span>
<span class="token comment">// 修改后代码</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_5-react-app-config-webpack-config-js修改alias指向-指向下载到本地的react代码"><a href="#_5-react-app-config-webpack-config-js修改alias指向-指向下载到本地的react代码" class="header-anchor">#</a> 5.react-app/config/webpack.config.js修改alias指向，指向下载到本地的react代码</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 把之前的指向全部注释掉</span>
    <span class="token comment">// // Support React Native Web</span>
    <span class="token comment">// // https://www.smashingmagazine.com/2016/08/a-glimpse-into-the-future-with-react-native-for-web/</span>
    <span class="token comment">// 'react-native': 'react-native-web',</span>
    <span class="token comment">// // Allows for better profiling with ReactDevTools</span>
    <span class="token comment">// ...(isEnvProductionProfile &amp;&amp; {</span>
    <span class="token comment">//   'react-dom$': 'react-dom/profiling',</span>
    <span class="token comment">//   'scheduler/tracing': 'scheduler/tracing-profiling',</span>
    <span class="token comment">// }),</span>
    <span class="token comment">// ...(modules.webpackAliases || {}),</span>
    <span class="token comment">// 修改为下面这段指向</span>
    <span class="token literal-property property">react</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>paths<span class="token punctuation">.</span>appSrc<span class="token punctuation">,</span> <span class="token string">'react/packages/react'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string-property property">'react-dom'</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>paths<span class="token punctuation">.</span>appSrc<span class="token punctuation">,</span> <span class="token string">'react/packages/react-dom'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">shared</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>paths<span class="token punctuation">.</span>appSrc<span class="token punctuation">,</span> <span class="token string">'react/packages/shared'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string-property property">'react-reconciler'</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>
      paths<span class="token punctuation">.</span>appSrc<span class="token punctuation">,</span>
      <span class="token string">'react/packages/react-reconciler'</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string-property property">'legacy-events'</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>
      paths<span class="token punctuation">.</span>appSrc<span class="token punctuation">,</span>
      <span class="token string">'react/packages/legacy-events'</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">scheduler</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>paths<span class="token punctuation">.</span>appSrc<span class="token punctuation">,</span> <span class="token string">'react/packages/scheduler'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>PS：毕竟我们的目的，就是想调试本地的react代码。</p> <h2 id="_6-关掉eslint"><a href="#_6-关掉eslint" class="header-anchor">#</a> 6.关掉eslint</h2> <p>在react-app/config/webpack.config.js全局搜索disableESLintPlugin</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 将上面这段代码注释</span>
<span class="token comment">// const disableESLintPlugin = process.env.DISABLE_ESLINT_PLUGIN === 'true';</span>
<span class="token comment">// 把disableESLintPlugin改为true</span>
<span class="token keyword">const</span> disableESLintPlugin <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_7-先将项目运行起来"><a href="#_7-先将项目运行起来" class="header-anchor">#</a> 7.先将项目运行起来</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm run start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我们先将项目跑起来，再看看报什么错。emmm，貌似报了不少错，我们一个个来解决!</p> <h2 id="_8-修改第一个遇到的错误"><a href="#_8-修改第一个遇到的错误" class="header-anchor">#</a> 8.修改第一个遇到的错误</h2> <img src="/nxf-notes/front-frame/react/debug-react/4.png"> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 在文件开头引入SchedulerMock</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> SchedulerMock <span class="token keyword">from</span> <span class="token string">'scheduler/src/forks/SchedulerMock'</span><span class="token punctuation">;</span>
<span class="token comment">// 然后将后面的</span>
<span class="token comment">// export const unstable_yieldValue = Scheduler.unstable_yieldValue;</span>
<span class="token comment">// export const unstable_setDisableYieldValue = Scheduler.unstable_setDisableYieldValue;</span>
<span class="token comment">// 改为</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> unstable_yieldValue <span class="token operator">=</span> SchedulerMock<span class="token punctuation">.</span>unstable_yieldValue<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> unstable_setDisableYieldValue <span class="token operator">=</span> SchedulerMock<span class="token punctuation">.</span>unstable_setDisableYieldValue<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_9-项目跑起来了-但是我们依然能在浏览器控制台看到报错"><a href="#_9-项目跑起来了-但是我们依然能在浏览器控制台看到报错" class="header-anchor">#</a> 9.项目跑起来了，但是我们依然能在浏览器控制台看到报错</h2> <img src="/nxf-notes/front-frame/react/debug-react/5.png"> <p>看来是环境变量没有设置
在react-app/config/env.js，全局搜索stringified</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> stringified <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string-property property">'process.env'</span><span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>raw<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">env<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      env<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>raw<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> env<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 加上</span>
    <span class="token literal-property property">__DEV__</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><img src="/nxf-notes/front-frame/react/debug-react/6.png"> <p>看来还有未设置的环境变量，那我们继续添加</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> stringified <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string-property property">'process.env'</span><span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>raw<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">env<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      env<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>raw<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> env<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">__DEV__</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 加上</span>
    <span class="token literal-property property">__EXPERIMENTAL__</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><img src="/nxf-notes/front-frame/react/debug-react/7.png"> <p>好吧，还有一个环境变量</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> stringified <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string-property property">'process.env'</span><span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>raw<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">env<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      env<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>raw<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> env<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">__DEV__</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">__EXPERIMENTAL__</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 加上</span>
    <span class="token literal-property property">__PROFILE__</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_10-解决-secret-internals-do-not-use-or-you-will-be-fired问题"><a href="#_10-解决-secret-internals-do-not-use-or-you-will-be-fired问题" class="header-anchor">#</a> 10.解决__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED问题</h2> <img src="/nxf-notes/front-frame/react/debug-react/8.png"> <p>修改react-app/src/react/packages/shared/ReactSharedInternals.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 注释这段</span>
<span class="token comment">// import * as React from 'react';</span>

<span class="token comment">// const ReactSharedInternals =</span>
<span class="token comment">//   React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;</span>

<span class="token comment">// 添加这段</span>
<span class="token keyword">import</span> ReactSharedInternals <span class="token keyword">from</span> <span class="token string">'../react/src/ReactSharedInternals'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> ReactSharedInternals<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_11-this-module-must-be-shimmed-by-a-specific-renderer"><a href="#_11-this-module-must-be-shimmed-by-a-specific-renderer" class="header-anchor">#</a> 11.This module must be shimmed by a specific renderer</h2> <img src="/nxf-notes/front-frame/react/debug-react/9.png"> <p>修改react-app/src/react/packages/react-reconciler/src/ReactFiberHostConfig.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 注释这段</span>
<span class="token comment">// throw new Error('This module must be shimmed by a specific renderer.');</span>
<span class="token comment">// 加入这段</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./forks/ReactFiberHostConfig.dom'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_12-跑起来了"><a href="#_12-跑起来了" class="header-anchor">#</a> 12.跑起来了</h2> <img src="/nxf-notes/front-frame/react/debug-react/10.png"> <h2 id="_13-开始debug"><a href="#_13-开始debug" class="header-anchor">#</a> 13.开始debug</h2> <p>在app.js文件中加个debugger</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'./index.css'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> reportWebVitals <span class="token keyword">from</span> <span class="token string">'./reportWebVitals'</span><span class="token punctuation">;</span>

<span class="token keyword">debugger</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> root <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>点击运行调试，选择chrome环境</p> <img src="/nxf-notes/front-frame/react/debug-react/11.png"> <p>端口改为当前项目的服务端口3000，点击运行和调试</p> <img src="/nxf-notes/front-frame/react/debug-react/12.png"> <h2 id="_14-大功告成"><a href="#_14-大功告成" class="header-anchor">#</a> 14.大功告成</h2> <img src="/nxf-notes/front-frame/react/debug-react/13.png"></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/13/2022, 3:26:49 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/nxf-notes/blogs/front-frame/react/introduction.html" class="prev">
        introduction
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/nxf-notes/assets/js/app.cd794865.js" defer></script><script src="/nxf-notes/assets/js/2.dc5a3d57.js" defer></script><script src="/nxf-notes/assets/js/18.e542e422.js" defer></script>
  </body>
</html>
